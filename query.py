from sets import Set
from collections import Counter
import pickle

all_cves = pickle.load(open("all_cves.pkl", 'rb'))
extensions_file = open("extension_cves", 'rb')
extensions = pickle.load(extensions_file)

for year in range(2002, 2019):
	print "In " + str(year) + " there were " + str(len(all_cves[year])) + " cves with github patches."


top_10_extensions = list()

for extension in extensions:
	if(len(top_10_extensions) < 10):
		top_10_extensions.append((extension, len(extensions[extension])))
	else:
		sortedTop = sorted(top_10_extensions, key = lambda top_ext: top_ext[1], reverse=True)
		if (len(extensions[extension]) >= sortedTop[9]):
			del sortedTop[9]
			sortedTop.append((extension, len(extensions[extension])))
			top_10_extensions = sortedTop

sortedTop = sorted(top_10_extensions, key = lambda top_ext: top_ext[1], reverse=True)

print "The top 10 extensions are:"
for extension, number in sortedTop:
	print extension, number






