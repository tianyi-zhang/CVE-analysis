p: Project = input;
count: output sum of int;


mentionsCVE := function(node: Project): bool{
    foreach (i: int; def(node.code_repositories[i]))
        {
      foreach (j: int; def(node.code_repositories[i].revisions[j]))
        {
    	    if(match(`cve`, lowercase(node.revisions[j].log))){
    	       return true;
    	    }
    	}
    }
    return false;
};


visit(p, visitor {
	before node: Project -> 
	{
	    ifall (i: int; !match(`^java$`, lowercase(n.programming_languages[i]))) stop;
	    if (mentionsCVE(node)){
	        count<<1;
	    }
	}
});
