p: Project = input;
count: output sum of int;
data: output collection of string;

mentionsCVE := function(node: Project): bool{
    flag := false;
    foreach (i: int; def(node.code_repositories[i]))
        {
      foreach (j: int; def(node.code_repositories[i].revisions[j]))
        {
    	    if(match(`cve-20`, lowercase(node.code_repositories[i].revisions[j].log))){
    	       
# We want the 
#- the repo name
#- the repo url
#- the commit SHA code
#- the commit message
    	       
    	       metadata := format("%s ;;; %s ;;; %s ;;; %s", node.name, node.code_repositories[i].url, node.code_repositories[i].revisions[j].id, node.code_repositories[i].revisions[j].log);
    	       stripped_metadata := strreplace (metadata, "\n", "", true);
    	       
    	       data << stripped_metadata;
    	       flag = true;
    	    }
    	}
    }
    
    return flag;
};


visit(p, visitor {
	before node: Project -> 
	{
	    ifall (i: int; !match(`^java$`, lowercase(node.programming_languages[i]))) stop;
	    if (mentionsCVE(node)){
	        count<<1;
	    }
	}
});
